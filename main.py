import telebot
import random
import os
import time
from telebot import types

# ุชูฺฉู ุฑุจุงุช ุงุฒ environment variable
BOT_TOKEN = os.getenv('BOT_TOKEN', 'YOUR_BOT_TOKEN_HERE')

bot = telebot.TeleBot(BOT_TOKEN)

# ฺฉุงุฑุช ูุง ุชุงุฑูุช ฺฉุงูู
tarot_cards = {
    "ุงุญูู (The Fool)": "๐ฑ ุดุฑูุน ุฌุฏุฏุ ูุงุฌุฑุงุฌูุ ุจโูพุฑูุง ูุซุจุชุ ุขุฒุงุฏ ุงุฒ ุชุฑุณ. ููุช ุฑุณฺฉ ฺฉุฑุฏู ู ูุฏู ฺฏุฐุงุดุชู ุจู ูุณุฑ ุฌุฏุฏู!",
    "ุฌุงุฏูฺฏุฑ (The Magician)": "โจ ูุฏุฑุช ุงุฑุงุฏูุ ุฎูุงูุชุ ููุงุฑุชุ ุชูุงูุง ุชุญูู ุขุฑุฒููุง. ููู ุงุจุฒุงุฑูุง ุฏุฑ ุฏุณุชุงู ุดูุงุณุช!",
    "ฺฉุงููู ุนุงู (High Priestess)": "๐ฎ ุดููุฏุ ุญฺฉูุช ุฏุฑููุ ุงุณุฑุงุฑุ ูุฏุฑุช ุฒูุงูู. ุจู ุตุฏุง ุฏู ุฎูุฏุชูู ฺฏูุด ุจุฏุฏ.",
    "ุงููพุฑุงุชูุฑุณ (The Empress)": "๐ธ ูุงุฏุฑุ ุญุงุตูุฎุฒุ ุทุจุนุชุ ุนุดู ุจโูุฏ ู ุดุฑุท. ุฒูุงู ุฑุดุฏ ู ุดฺฉููุง ุงุณุช.",
    "ุงููพุฑุงุชูุฑ (The Emperor)": "๐ ุงูุชุฏุงุฑุ ุฑูุจุฑุ ูุธูุ ูพุฏุฑ ุณุงูุงุฑ. ุฒูุงู ุชุตููโฺฏุฑ ูุงุทุน ู ุฑูุจุฑ ุงุณุช.",
    "ฺฉุดุด (The Hierophant)": "๐ฟ ุณูุชุ ุขููุฒุดุ ุฑุงูููุง ูุนููุ ุฏุงูุด ูุฐูุจ. ุงุฒ ุชุฌุฑุจู ุฏฺฏุฑุงู ุงุฏ ุจฺฏุฑุฏ.",
    "ุนุงุดูุงู (The Lovers)": "๐ ุนุดูุ ุงูุชุฎุงุจุ ุฑุงุจุทูุ ููุงููฺฏ. ุชุตูู ููู ูพุด ุฑู ุดูุงุณุช.",
    "ุงุฑุงุจู (The Chariot)": "๐ ูพุฑูุฒุ ุงุฑุงุฏู ููุ ฺฉูุชุฑูุ ุญุฑฺฉุช ุจู ุฌูู. ุจุง ุนุฒู ูู ุจู ูุฏู ุจุฑุณุฏ.",
    "ูุฏุฑุช (Strength)": "๐ฆ ุดุฌุงุนุช ุฏุฑููุ ฺฉูุชุฑู ุฎูุดุชูุ ุตุจุฑุ ูุฏุฑุช ููุงู. ูุฏุฑุช ูุงูุน ุงุฒ ุฏุฑูู ูโุขุฏ.",
    "ุฏุฑููฺฏุฑุง (The Hermit)": "๐ฏ๏ธ ุฌุณุชุฌู ุฏุฑููุ ุฎููุชุ ุญฺฉูุชุ ุฑุงูููุง. ุฒูุงู ุชูฺฉุฑ ู ุฎูุฏุดูุงุณ ุงุณุช.",
    "ฺุฑุฎ ุจุฎุช (Wheel of Fortune)": "๐ก ุชุบุฑุ ุดุงูุณุ ุณุฑููุดุชุ ฺุฑุฎู ุฒูุฏฺฏ. ุชุบุฑุงุช ูุซุจุช ุฏุฑ ุฑุงู ุงุณุช!",
    "ุนุฏุงูุช (Justice)": "โ๏ธ ุชูุงุฒูุ ุงูุตุงูุ ูุงูููุ ุนูุงูุจ ุงุนูุงู. ุนุฏุงูุช ุจุฑูุฑุงุฑ ุฎูุงูุฏ ุดุฏ.",
    "ุขูุฎุชู (The Hanged Man)": "๐ ูุฑุจุงูุ ูฺฏุงู ูุชูุงูุชุ ุตุจุฑุ ุฑูุง. ฺฏุงู ุจุงุฏ ููุชุธุฑ ุจูุงูุฏ.",
    "ูุฑฺฏ (Death)": "๐ฆ ุชุญููุ ูพุงุงู ู ุดุฑูุนุ ุชุบุฑ ุจูุงุฏุ ุชููุฏ ุฏูุจุงุฑู. ูพุงุงู ฺุฒุ ุดุฑูุน ฺุฒ ุจูุชุฑ ุงุณุช.",
    "ุงุนุชุฏุงู (Temperance)": "๐ ุชุนุงุฏูุ ูุงููโุฑูุ ุขุฑุงูุดุ ููุงููฺฏ. ููู ฺุฒ ุจู ุชุนุงุฏู ูุงุฒ ุฏุงุฑุฏ.",
    "ุดุทุงู (The Devil)": "โ๏ธ ูุงุจุณุชฺฏุ ูุญุฏูุฏุชุ ูุณูุณูุ ูุงุฏโฺฏุฑุง. ุฒูุฌุฑูุง ุฎูุฏ ุฑุง ุจุดฺฉูุฏ.",
    "ุจุฑุฌ (The Tower)": "โก ุชุบุฑ ูุงฺฏูุงูุ ูุฑุงูุ ุขุดูุชฺฏุ ุจุฏุงุฑ. ุชฺฉุงู ุจุฒุฑฺฏ ุฏุฑ ุฑุงู ุงุณุช.",
    "ุณุชุงุฑู (The Star)": "โญ ุงูุฏุ ุงููุงูุ ุขุฑุฒูุ ุดูุง. ุงูุฏ ุฑุง ุงุฒ ุฏุณุช ูุฏูุฏุ ููู ฺุฒ ุจูุชุฑ ูโุดูุฏ.",
    "ูุงู (The Moon)": "๐ ุชูููุ ุชุฑุณุ ูุงุขฺฏุงูุ ุฑุคุง. ูุฑุงูุจ ูุฑุจ ู ุชูููุงุช ุจุงุดุฏ.",
    "ุฎูุฑุดุฏ (The Sun)": "โ๏ธ ุดุงุฏุ ููููุชุ ุญุงุชุ ูุซุจุช ุงูุฏุด. ุฑูุฒูุง ุฑูุดู ุฏุฑ ูพุด ุงุณุช!",
    "ูุถุงูุช (Judgement)": "๐ฏ ุฑุณุชฺฏุงุฑุ ุจุฎุดุดุ ุจุฏุงุฑุ ุดุฑูุน ุฏูุจุงุฑู. ุฒูุงู ุงุฑุฒุงุจ ู ุชุบุฑ ูุฑุง ุฑุณุฏู.",
    "ุฌูุงู (The World)": "๐ ุชฺฉููุ ููููุชุ ุชุญูู ูุฏูุ ฺฉูุงู. ุจู ูุฏู ููุง ุฑุณุฏูโุงุฏ!"
}

# ูพุงูโูุง ุงูฺฏุฒุด
motivational_messages = [
    "โจ ุงุฏุช ุจุงุดู ฺฉู ูุฑ ูพุงุงูุ ุดุฑูุน ุฌุฏุฏ ูุณุช",
    "๐ ูุฏุฑุช ุชุบุฑ ุฒูุฏฺฏุช ุชู ุฏุณุชุงู ุฎูุฏุชู",
    "๐ซ ุจู ุดููุฏุช ุงุนุชูุงุฏ ฺฉูุ ุฑุงู ุฏุฑุณุช ุฑู ูุดููุช ูุฏู",
    "๐ ฺฏุงู ุจุงุฏ ุตุจุฑ ฺฉู ุชุง ุฒูุงู ููุงุณุจ ูุฑุง ุจุฑุณู",
    "โ๏ธ ูุฑ ฺุงูุด ูุฑุตุช ุจุฑุง ุฑุดุฏ ู ุงุฏฺฏุฑ ุงุณุช",
    "๐ฆ ุชุบุฑ ุจุฎุด ุทุจุน ุฒูุฏฺฏ ุงุณุชุ ุงุฒ ุขู ูุชุฑุณุฏ",
    "๐ฏ ุฑู ูุฏูโูุงุชูู ูุชูุฑฺฉุฒ ุจูููุฏุ ููููุช ูุฒุฏฺฉู",
    "๐ช ูุฏุฑุช ุฏุฑูู ุดูุง ุจุดุชุฑ ุงุฒ ุงูู ฺุฒ ูุณุช ฺฉู ูฺฉุฑ ูโฺฉูุฏ"
]

@bot.message_handler(commands=['start'])
def send_welcome(message):
    welcome_text = f"""
๐ฎ ุณูุงู {message.from_user.first_name}! 
ุจู ุฑุจุงุช ูุงู ุชุงุฑูุช ุฎูุด ุงููุฏ! 

โจ ุจุฑุง ฺฏุฑูุชู ูุงู ุชฺฉ ูุช ุชุงุฑูุช:
/tarot - ุฏุฑุงูุช ูุงู

๐ ุณุงุฑ ุฏุณุชูุฑุงุช:
/help - ุฑุงูููุง ฺฉุงูู
/about - ุฏุฑุจุงุฑู ุชุงุฑูุช

๐ ุณูุงูุช ุฑู ุจุง ุชูุฑฺฉุฒ ู ููุจ ุจุงุฒ ุจูพุฑุณ ุชุง ุจูุชุฑู ุฑุงูููุง ุฑู ุฏุฑุงูุช ฺฉู
    """
    
    # ุงุฌุงุฏ ฺฉุจูุฑุฏ
    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    btn1 = types.KeyboardButton("๐ฎ ูุงู ุชุงุฑูุช")
    btn2 = types.KeyboardButton("โ ุฑุงูููุง")
    btn3 = types.KeyboardButton("๐ ุฏุฑุจุงุฑู ุชุงุฑูุช")
    markup.add(btn1)
    markup.add(btn2, btn3)
    
    bot.reply_to(message, welcome_text, reply_markup=markup)

@bot.message_handler(commands=['help'])
def send_help(message):
    help_text = """
๐ ุฑุงูููุง ฺฉุงูู ุฑุจุงุช ูุงู ุชุงุฑูุช:

๐ฎ ุฏุณุชูุฑุงุช ุงุตู:
โข /tarot - ุฏุฑุงูุช ูุงู ุชฺฉ ูุช
โข /help - ููุงุด ุงู ุฑุงูููุง  
โข /about - ุงุทูุงุนุงุช ุฏุฑุจุงุฑู ุชุงุฑูุช

๐ฏ ูุญูู ุงุณุชูุงุฏู:
1๏ธโฃ ุณูุงู ุฎูุฏ ุฑุง ุฏุฑ ุฐูู ูุดุฎุต ฺฉูุฏ
2๏ธโฃ ุจุง ุชูุฑฺฉุฒ ุฏุณุชูุฑ /tarot ุฑุง ุจุฒูุฏ
3๏ธโฃ ฺฉุงุฑุช ุชุงุฑูุช ู ุชูุณุฑ ุขู ุฑุง ุฏุฑุงูุช ฺฉูุฏ
4๏ธโฃ ูโุชููุฏ ูุงู ุฌุฏุฏ ุจฺฏุฑุฏ

๐ก ูฺฉุงุช ููู:
โ ุณูุงูุงุช ูุดุฎุต ุจูุชุฑู ุฌูุงุจ ุฑู ูุฏู
โ ุจุง ุฐูู ุจุงุฒ ู ููุจ ุขูุงุฏู ูุงู ุจฺฏุฑุฏ  
โ ุงุฒ ุฑุงูููุงโูุง ุฏุฑ ุฒูุฏฺฏ ุงุณุชูุงุฏู ฺฉูุฏ
โ๏ธ ูุงูโูุง ุฑุงูููุง ูุณุชูุฏุ ูู ุชุนูโฺฉููุฏู ุณุฑููุดุช
    """
    bot.reply_to(message, help_text)

@bot.message_handler(commands=['about'])
def send_about(message):
    about_text = """
๐ ุฏุฑุจุงุฑู ุชุงุฑูุช:

๐ฎ ุชุงุฑูุช ฺุณุชุ
ุชุงุฑูุช ูุฌููุนูโุง ุงุฒ 78 ฺฉุงุฑุช ุงุณุช ฺฉู ุจุฑุง ุฏุฑฺฉ ุจูุชุฑ ุฎูุฏ ู ุฑุงูููุง ุฏุฑ ุชุตููโฺฏุฑโูุง ุงุณุชูุงุฏู ูโุดูุฏ.

๐ด ุขุฑฺฉุงูุง ุงุตู (Major Arcana):
22 ฺฉุงุฑุช ุงุตู ฺฉู ูุดุงูโุฏููุฏู ูุฑุงุญู ุงุตู ุณูุฑ ุฑูุญ ุงูุณุงู ุงุณุช.

โจ ูุฏู:
โข ุฎูุฏุดูุงุณ ุจุดุชุฑ
โข ุฑุงูููุง ุฏุฑ ุชุตููโฺฏุฑโูุง  
โข ุฏุฑฺฉ ุจูุชุฑ ูููุนุชโูุง ุฒูุฏฺฏ
โข ุชููุช ุดููุฏ ู ุจุตุฑุช ุฏุฑูู

๐ ุงุฏุขูุฑ:
ุงู ุฑุจุงุช ุจุฑุง ุฑุงูููุง ู ุชูฺฉุฑ ุณุงุฎุชู ุดุฏู. ุชุตููุงุช ููู ุฑุง ุจุง ูฺฉุฑ ู ูุดูุฑุช ุจฺฏุฑุฏ.
    """
    bot.reply_to(message, about_text)

@bot.message_handler(commands=['tarot'])
def tarot_reading(message):
    get_tarot_reading(message)

def get_tarot_reading(message):
    # ุงูุชุฎุงุจ ุชุตุงุฏู ฺฉุงุฑุช
    card_name = random.choice(list(tarot_cards.keys()))
    card_meaning = tarot_cards[card_name]
    motivational_msg = random.choice(motivational_messages)
    
    # ุณุงุฎุช ูพุงู ูุงู
    reading_text = f"""
๐ฎ **ูุงู ุชฺฉ ูุช ุดูุง:**

๐ด **ฺฉุงุฑุช:** {card_name}

๐ **ุฑุงูููุง:** 
{card_meaning}

๐ซ **ูพุงู ุงูุฑูุฒ:**
{motivational_msg}

โโโโโโโโโโโโโโโโโโโโ
โก ุงู ูุงู ุฑุงูููุง ฺฉู ุงุณุช. ุชุตููุงุช ููู ุฑุง ุจุง ุชูฺฉุฑ ู ูุดูุฑุช ุจฺฏุฑุฏ.
    """
    
    # ุงุฌุงุฏ ฺฉุจูุฑุฏ inline
    markup = types.InlineKeyboardMarkup()
    new_reading_btn = types.InlineKeyboardButton("๐ ูุงู ุฌุฏุฏ", callback_data="new_tarot")
    share_btn = types.InlineKeyboardButton("๐ค ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ", callback_data="share")
    markup.add(new_reading_btn)
    markup.add(share_btn)
    
    bot.reply_to(message, reading_text, parse_mode='Markdown', reply_markup=markup)

@bot.callback_query_handler(func=lambda call: call.data == "new_tarot")
def new_tarot_reading(call):
    # ุงูุชุฎุงุจ ฺฉุงุฑุช ุฌุฏุฏ
    card_name = random.choice(list(tarot_cards.keys()))
    card_meaning = tarot_cards[card_name]
    motivational_msg = random.choice(motivational_messages)
    
    reading_text = f"""
๐ฎ **ูุงู ุฌุฏุฏ ุดูุง:**

๐ด **ฺฉุงุฑุช:** {card_name}

๐ **ุฑุงูููุง:** 
{card_meaning}

๐ซ **ูพุงู ุงูุฑูุฒ:**
{motivational_msg}

โโโโโโโโโโโโโโโโโโโโ
โก ุงู ูุงู ุฑุงูููุง ฺฉู ุงุณุช. ุชุตููุงุช ููู ุฑุง ุจุง ุชูฺฉุฑ ู ูุดูุฑุช ุจฺฏุฑุฏ.
    """
    
    markup = types.InlineKeyboardMarkup()
    new_reading_btn = types.InlineKeyboardButton("๐ ูุงู ุฌุฏุฏ", callback_data="new_tarot")
    share_btn = types.InlineKeyboardButton("๐ค ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ", callback_data="share")
    markup.add(new_reading_btn)
    markup.add(share_btn)
    
    try:
        bot.edit_message_text(reading_text, call.message.chat.id, call.message.message_id, 
                             parse_mode='Markdown', reply_markup=markup)
    except:
        bot.send_message(call.message.chat.id, reading_text, parse_mode='Markdown', reply_markup=markup)

@bot.callback_query_handler(func=lambda call: call.data == "share")
def share_reading(call):
    share_text = "๐ฎ ูุงู ุชุงุฑูุช ฺฏุฑูุชู! ุดูุง ูู ุงูุชุญุงู ฺฉูุฏ: @YourBotUsername"
    bot.answer_callback_query(call.id, "ุจุฑุง ุงุดุชุฑุงฺฉโฺฏุฐุงุฑุ ูพุงู ุจุงูุง ุฑู ููุฑูุงุฑุฏ ฺฉูุฏ! ๐ค")

# ูพุงุณุฎ ุจู ูพุงูโูุง ูุชู
@bot.message_handler(func=lambda message: message.text == "๐ฎ ูุงู ุชุงุฑูุช")
def handle_tarot_button(message):
    get_tarot_reading(message)

@bot.message_handler(func=lambda message: message.text == "โ ุฑุงูููุง")
def handle_help_button(message):
    send_help(message)

@bot.message_handler(func=lambda message: message.text == "๐ ุฏุฑุจุงุฑู ุชุงุฑูุช")
def handle_about_button(message):
    send_about(message)

@bot.message_handler(func=lambda message: True)
def handle_message(message):
    # ูพุงุณุฎ ุจู ูพุงูโูุง ุนุงุฏ
    responses = [
        "๐ฎ ุจุฑุง ุฏุฑุงูุช ูุงู ุชุงุฑูุชุ ุฏฺฉูู 'ูุงู ุชุงุฑูุช' ุฑู ุจุฒู ุง /tarot ุชุงูพ ฺฉู!",
        "โจ ุขูุงุฏูโุง ุจุฑุง ฺฉุดู ูพุงูโูุง ุฌูุงูุ ูุงู ุชุงุฑูุช ุจฺฏุฑ! ๐ด",
        "๐ ฺฉุงุฑุชโูุง ุชุงุฑูุช ููุชุธุฑ ูุณุชู ุชุง ุฑุงูููุงโุช ฺฉูู! ๐ฎ",
        "๐ซ ุณูุงูุช ุฑู ุฏุฑ ุฐูู ูุดุฎุต ฺฉู ู ูุงู ุชุงุฑูุช ุจฺฏุฑ! โจ"
    ]
    
    bot.reply_to(message, random.choice(responses))

# ุงุฌุฑุง ุฑุจุงุช ุจุง ูุฏุฑุช ุฎุทุง
def main():
    print("๐ฎ ุฑุจุงุช ูุงู ุชุงุฑูุช ุดุฑูุน ุดุฏ...")
    while True:
        try:
            bot.polling(none_stop=True, interval=1, timeout=60)
        except Exception as e:
            print(f"ุฎุทุง ุฑุฎ ุฏุงุฏ: {e}")
            print("ุชูุงุด ูุฌุฏุฏ ุฏุฑ 15 ุซุงูู...")
            time.sleep(15)

if __name__ == "__main__":
    main()
